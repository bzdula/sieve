{
  "capabilities": [
    "EncodedCharacter",
    "FileInto",
    "FileInto",
    "Envelope",
    "FileInto"
  ],
  "commands": [
    {
      "If": [
        {
          "test": {
            "Size": {
              "over": true,
              "limit": 102400
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Size": {
              "over": true,
              "limit": 102400
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    83,
                    117,
                    98,
                    106,
                    101,
                    99,
                    116
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    36,
                    36,
                    36
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "AnyOf": [
              {
                "Not": {
                  "Exists": {
                    "header_names": [
                      {
                        "Text": [
                          70,
                          114,
                          111,
                          109
                        ]
                      },
                      {
                        "Text": [
                          68,
                          97,
                          116,
                          101
                        ]
                      }
                    ],
                    "mime": false,
                    "mime_anychild": false
                  }
                }
              },
              {
                "Header": {
                  "header_list": [
                    {
                      "Text": [
                        102,
                        114,
                        111,
                        109
                      ]
                    }
                  ],
                  "key_list": [
                    {
                      "Text": [
                        102,
                        111,
                        111,
                        108,
                        64,
                        101,
                        120,
                        97,
                        109,
                        112,
                        108,
                        101,
                        46,
                        99,
                        111,
                        109
                      ]
                    }
                  ],
                  "match_type": "Contains",
                  "comparator": "AsciiCaseMap",
                  "index": null,
                  "index_last": false,
                  "mime": false,
                  "mime_opts": "None",
                  "mime_anychild": false,
                  "list": false
                }
              }
            ]
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    83,
                    117,
                    98,
                    106,
                    101,
                    99,
                    116
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    77,
                    65,
                    75,
                    69,
                    32,
                    77,
                    79,
                    78,
                    69,
                    89,
                    32,
                    70,
                    65,
                    83,
                    84
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "Octet",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Size": {
              "over": true,
              "limit": 512000
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    102,
                    114,
                    111,
                    109
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    99,
                    111,
                    121,
                    111,
                    116,
                    101
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            "Discard"
          ]
        },
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    115,
                    117,
                    98,
                    106,
                    101,
                    99,
                    116
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    36,
                    36,
                    36
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            "Discard"
          ]
        },
        {
          "test": "True",
          "commands": [
            {
              "FileInto": {
                "copy": false,
                "create": false,
                "folder": {
                  "Text": [
                    73,
                    78,
                    66,
                    79,
                    88
                  ]
                },
                "flags": [],
                "mailbox_id": null,
                "special_use": null
              }
            }
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    70,
                    114,
                    111,
                    109
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    99,
                    111,
                    121,
                    111,
                    116,
                    101
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            {
              "Redirect": {
                "copy": false,
                "address": {
                  "Text": [
                    97,
                    99,
                    109,
                    64,
                    101,
                    120,
                    97,
                    109,
                    112,
                    108,
                    101,
                    46,
                    99,
                    111,
                    109
                  ]
                },
                "notify": "Default",
                "ret": "Default",
                "by_time": "None",
                "list": false
              }
            }
          ]
        },
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    83,
                    117,
                    98,
                    106,
                    101,
                    99,
                    116
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    36,
                    36,
                    36
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            {
              "Redirect": {
                "copy": false,
                "address": {
                  "Text": [
                    112,
                    111,
                    115,
                    116,
                    109,
                    97,
                    115,
                    116,
                    101,
                    114,
                    64,
                    101,
                    120,
                    97,
                    109,
                    112,
                    108,
                    101,
                    46,
                    99,
                    111,
                    109
                  ]
                },
                "notify": "Default",
                "ret": "Default",
                "by_time": "None",
                "list": false
              }
            }
          ]
        },
        {
          "test": "True",
          "commands": [
            {
              "Redirect": {
                "copy": false,
                "address": {
                  "Text": [
                    102,
                    105,
                    101,
                    108,
                    100,
                    64,
                    101,
                    120,
                    97,
                    109,
                    112,
                    108,
                    101,
                    46,
                    99,
                    111,
                    109
                  ]
                },
                "notify": "Default",
                "ret": "Default",
                "by_time": "None",
                "list": false
              }
            }
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    102,
                    114,
                    111,
                    109
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    99,
                    111,
                    121,
                    111,
                    116,
                    101
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            {
              "FileInto": {
                "copy": false,
                "create": false,
                "folder": {
                  "Text": [
                    73,
                    78,
                    66,
                    79,
                    88,
                    46,
                    104,
                    97,
                    114,
                    97,
                    115,
                    115,
                    109,
                    101,
                    110,
                    116
                  ]
                },
                "flags": [],
                "mailbox_id": null,
                "special_use": null
              }
            }
          ]
        }
      ]
    },
    {
      "Redirect": {
        "copy": false,
        "address": {
          "Text": [
            98,
            97,
            114,
            116,
            64,
            101,
            120,
            97,
            109,
            112,
            108,
            101,
            46,
            99,
            111,
            109
          ]
        },
        "notify": "Default",
        "ret": "Default",
        "by_time": "None",
        "list": false
      }
    },
    {
      "If": [
        {
          "test": {
            "Size": {
              "over": false,
              "limit": 1048576
            }
          },
          "commands": [
            {
              "Keep": {
                "flags": []
              }
            }
          ]
        },
        {
          "test": "True",
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    102,
                    114,
                    111,
                    109
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    105,
                    100,
                    105,
                    111,
                    116,
                    64,
                    101,
                    120,
                    97,
                    109,
                    112,
                    108,
                    101,
                    46,
                    99,
                    111,
                    109
                  ]
                }
              ],
              "match_type": "Contains",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Address": {
              "header_list": [
                {
                  "Text": [
                    102,
                    114,
                    111,
                    109
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    116,
                    105,
                    109,
                    64,
                    101,
                    120,
                    97,
                    109,
                    112,
                    108,
                    101,
                    46,
                    99,
                    111,
                    109
                  ]
                }
              ],
              "address_part": "All",
              "match_type": "Is",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Envelope": {
              "header_list": [
                {
                  "Text": [
                    102,
                    114,
                    111,
                    109
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    116,
                    105,
                    109,
                    64,
                    101,
                    120,
                    97,
                    109,
                    112,
                    108,
                    101,
                    46,
                    99,
                    111,
                    109
                  ]
                }
              ],
              "address_part": "All",
              "match_type": "Is",
              "comparator": "AsciiCaseMap",
              "zone": null,
              "list": false
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Not": {
              "Exists": {
                "header_names": [
                  {
                    "Text": [
                      70,
                      114,
                      111,
                      109
                    ]
                  },
                  {
                    "Text": [
                      68,
                      97,
                      116,
                      101
                    ]
                  }
                ],
                "mime": false,
                "mime_anychild": false
              }
            }
          },
          "commands": [
            "Discard"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "AnyOf": [
              {
                "Header": {
                  "header_list": [
                    {
                      "Text": [
                        88,
                        45,
                        67,
                        97,
                        102,
                        102,
                        101,
                        105,
                        110,
                        101
                      ]
                    }
                  ],
                  "key_list": [
                    {
                      "Text": []
                    }
                  ],
                  "match_type": "Is",
                  "comparator": "AsciiCaseMap",
                  "index": null,
                  "index_last": false,
                  "mime": false,
                  "mime_opts": "None",
                  "mime_anychild": false,
                  "list": false
                }
              },
              {
                "Header": {
                  "header_list": [
                    {
                      "Text": [
                        88,
                        45,
                        67,
                        97,
                        102,
                        102,
                        101,
                        105,
                        110,
                        101
                      ]
                    }
                  ],
                  "key_list": [
                    {
                      "Text": []
                    }
                  ],
                  "match_type": "Contains",
                  "comparator": "AsciiCaseMap",
                  "index": null,
                  "index_last": false,
                  "mime": false,
                  "mime_opts": "None",
                  "mime_anychild": false,
                  "list": false
                }
              },
              {
                "Not": {
                  "Header": {
                    "header_list": [
                      {
                        "Text": [
                          67,
                          99
                        ]
                      }
                    ],
                    "key_list": [
                      {
                        "List": [
                          "MatchOne",
                          {
                            "MatchMany": 1
                          }
                        ]
                      }
                    ],
                    "match_type": "Matches",
                    "comparator": "AsciiCaseMap",
                    "index": null,
                    "index_last": false,
                    "mime": false,
                    "mime_opts": "None",
                    "mime_anychild": false,
                    "list": false
                  }
                }
              }
            ]
          },
          "commands": [
            "Stop"
          ]
        }
      ]
    },
    {
      "If": [
        {
          "test": {
            "Header": {
              "header_list": [
                {
                  "Text": [
                    83,
                    101,
                    110,
                    100,
                    101,
                    114
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    111,
                    119,
                    110,
                    101,
                    114,
                    45,
                    105,
                    101,
                    116,
                    102,
                    45,
                    109,
                    116,
                    97,
                    45,
                    102,
                    105,
                    108,
                    116,
                    101,
                    114,
                    115,
                    64,
                    105,
                    109,
                    99,
                    46,
                    111,
                    114,
                    103
                  ]
                }
              ],
              "match_type": "Is",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_opts": "None",
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            {
              "FileInto": {
                "copy": false,
                "create": false,
                "folder": {
                  "Text": [
                    102,
                    105,
                    108,
                    116,
                    101,
                    114
                  ]
                },
                "flags": [],
                "mailbox_id": null,
                "special_use": null
              }
            }
          ]
        },
        {
          "test": {
            "Address": {
              "header_list": [
                {
                  "Text": [
                    70,
                    114,
                    111,
                    109
                  ]
                },
                {
                  "Text": [
                    84,
                    111
                  ]
                }
              ],
              "key_list": [
                {
                  "Text": [
                    101,
                    120,
                    97,
                    109,
                    112,
                    108,
                    101,
                    46,
                    99,
                    111,
                    109
                  ]
                }
              ],
              "address_part": "Domain",
              "match_type": "Is",
              "comparator": "AsciiCaseMap",
              "index": null,
              "index_last": false,
              "mime": false,
              "mime_anychild": false,
              "list": false
            }
          },
          "commands": [
            {
              "Keep": {
                "flags": []
              }
            }
          ]
        },
        {
          "test": {
            "AnyOf": [
              {
                "Not": {
                  "Address": {
                    "header_list": [
                      {
                        "Text": [
                          84,
                          111
                        ]
                      },
                      {
                        "Text": [
                          67,
                          99
                        ]
                      },
                      {
                        "Text": [
                          66,
                          99,
                          99
                        ]
                      }
                    ],
                    "key_list": [
                      {
                        "Text": [
                          109,
                          101,
                          64,
                          101,
                          120,
                          97,
                          109,
                          112,
                          108,
                          101,
                          46,
                          99,
                          111,
                          109
                        ]
                      }
                    ],
                    "address_part": "All",
                    "match_type": "Contains",
                    "comparator": "AsciiCaseMap",
                    "index": null,
                    "index_last": false,
                    "mime": false,
                    "mime_anychild": false,
                    "list": false
                  }
                }
              },
              {
                "Header": {
                  "header_list": [
                    {
                      "Text": [
                        115,
                        117,
                        98,
                        106,
                        101,
                        99,
                        116
                      ]
                    }
                  ],
                  "key_list": [
                    {
                      "List": [
                        {
                          "MatchMany": 1
                        },
                        {
                          "Text": [
                            109,
                            97,
                            107,
                            101
                          ]
                        },
                        {
                          "MatchMany": 1
                        },
                        {
                          "Text": [
                            109,
                            111,
                            110,
                            101,
                            121
                          ]
                        },
                        {
                          "MatchMany": 1
                        },
                        {
                          "Text": [
                            102,
                            97,
                            115,
                            116
                          ]
                        },
                        {
                          "MatchMany": 1
                        }
                      ]
                    },
                    {
                      "List": [
                        {
                          "MatchMany": 1
                        },
                        {
                          "Text": [
                            117,
                            110,
                            105,
                            118,
                            101,
                            114,
                            115,
                            105,
                            116,
                            121
                          ]
                        },
                        {
                          "MatchMany": 1
                        },
                        {
                          "Text": [
                            100,
                            105,
                            112,
                            108
                          ]
                        },
                        {
                          "MatchMany": 1
                        },
                        {
                          "Text": [
                            109,
                            97,
                            115
                          ]
                        },
                        {
                          "MatchMany": 1
                        }
                      ]
                    }
                  ],
                  "match_type": "Matches",
                  "comparator": "AsciiCaseMap",
                  "index": null,
                  "index_last": false,
                  "mime": false,
                  "mime_opts": "None",
                  "mime_anychild": false,
                  "list": false
                }
              }
            ]
          },
          "commands": [
            {
              "FileInto": {
                "copy": false,
                "create": false,
                "folder": {
                  "Text": [
                    115,
                    112,
                    97,
                    109
                  ]
                },
                "flags": [],
                "mailbox_id": null,
                "special_use": null
              }
            }
          ]
        },
        {
          "test": "True",
          "commands": [
            {
              "FileInto": {
                "copy": false,
                "create": false,
                "folder": {
                  "Text": [
                    112,
                    101,
                    114,
                    115,
                    111,
                    110,
                    97,
                    108
                  ]
                },
                "flags": [],
                "mailbox_id": null,
                "special_use": null
              }
            }
          ]
        }
      ]
    }
  ]
}